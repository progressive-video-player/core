class Player extends HTMLElement{static get observedAttributes(){return["src"]}constructor(){super(),this.parent=null,this.elem=document.createElement("video"),this.plugins={video:new Set,skin:new Set,ad:new Set},this.activePlugins={video:null}}connectedCallback(){(this.parent=this.parentNode).appendChild(this.elem)}disconnectedCallback(){const e=this.parent;e.contains(this.elem)&&e.removeChild(this.elem),this.parent=null}attributeChangedCallback(e,t,i){if(t!==i)if("src"===e){if(!this.parent||!this.hasChildNodes())return;const e=this.activePlugins.video;if(e&&(e.unloadVideo(),this.activePlugins.video=null),!i)return;const t=this.childNodes;for(let e=0;e<t.length;e++){const n=t[e];if("function"==typeof n.loadVideo&&n.loadVideo(this.elem,i)){this.activePlugins.video=n;break}}}else"controls"===e||this.elem.setAttribute(e,i)}addEventListener(...e){this.elem.addEventListener(...e)}removeEventListener(...e){this.elem.removeEventListener(...e)}registerPlugin(e,t){const i=this.plugins[e];if(!i)return;if(i.add(t),"video"!==e||this.activePlugins.video)return;const n=this.getAttribute("src");n&&t.loadVideo(this.elem,n)&&(this.activePlugins.video=t)}unregisterPlugin(e,t){const i=this.plugins[e];i&&(this.activePlugins.video===t&&t.unloadVideo(),i.delete(t))}}class SkinPlugin extends HTMLElement{constructor(){super(),this.parent=null}connectedCallback(){const e=this.parent=this.parentNode,t=e.parentNode;t&&(this.initSkin(t),e.registerPlugin("skin",this))}disconnectedCallback(){const e=this.parent;this.deinitSkin(),e.unregisterPlugin("skin",this),this.parent=null}initSkin(){}deinitSkin(){}}class VideoPlugin extends HTMLElement{constructor(){super(),this.parent=null}connectedCallback(){(this.parent=this.parentNode).registerPlugin("video",this)}disconnectedCallback(){this.parent.unregisterPlugin("video",this),this.parent=null}loadVideo(){}unloadVideo(){}}export{Player,SkinPlugin,VideoPlugin};
//# sourceMappingURL=player-core.module.js.map